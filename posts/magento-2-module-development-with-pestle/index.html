<!doctype html><html><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>The Nomad Coder | Magento 2 Module Development with Pestle |</title><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=description content="Use code generation with Pestle to automate your workflow in Magento 2."><meta name=generator content="Hugo 0.83.1"><meta property="og:site_name" content="The Nomad Coder"><meta property="og:url" content="https://thenomadcoder.com/posts/magento-2-module-development-with-pestle/"><meta property="og:locale" content="en-us"><meta property="og:locale:alternate" content="en_US"><meta property="og:country-name" content="Indonesia"><meta property="og:email" content><meta property="og:title" content="Magento 2 Module Development with Pestle"><meta property="og:type" content="article"><meta property="article:published_time" content="2020-06-16"><meta property="og:description" content="Use code generation with Pestle to automate your workflow in Magento 2."><meta property="og:url" content="https://thenomadcoder.com/posts/magento-2-module-development-with-pestle/"><meta property="og:site_name" content="The Nomad Coder"><meta property="og:image" content="https://thenomadcoder.com/posts/magento-2-module-development-with-pestle/banner_huec524871fb59dadad0586cc7018d7fce_415044_1500x1500_fill_box_center_2.png"><meta property="og:image:alt" content="Magento 2 Module Development with Pestle"><meta property="og:tags" content="Magento 2"><meta property="og:tags" content="Pestle"><meta property="twitter:description" content="Use code generation with Pestle to automate your workflow in Magento 2."><meta property="twitter:title" content="Magento 2 Module Development with Pestle"><meta property="twitter:image" content="https://thenomadcoder.com/posts/magento-2-module-development-with-pestle/banner_huec524871fb59dadad0586cc7018d7fce_415044_1500x1500_fill_box_center_2.png"><meta name=google-site-verification content><meta name=application-name content="The Nomad Coder"><meta name=mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="black"><meta name=apple-mobile-web-app-title content="The Nomad Coder"><link rel=icon sizes=16x16 href=favicon-16x16.png><link rel=icon sizes=32x32 href=favicon-32x32.png><link rel=icon sizes=192x192 href=android-chrome-192x192.png><link rel=icon sizes=512x512 href=android-chrome-512x512.png><link rel=apple-touch-icon href=apple-touch-icon.png><meta name=msapplication-TileColor content="#ff0000"><link rel=manifest href=https://thenomadcoder.com/manifest.json><meta name=theme-color content="#ff0000"><link rel=author href=https://thenomadcoder.com/humans.txt><link rel=copyright href=https://thenomadcoder.com/copyright.html><meta name=monetization content="$ilp.uphold.com/PMDha7R3yZgG"><link rel=stylesheet href=https://thenomadcoder.com/css/highlight.css><link href=https://thenomadcoder.com/index.xml rel=alternate type=application/rss+xml title="The Nomad Coder"><link rel=stylesheet href=https://unpkg.com/tachyons@4.12.0/css/tachyons.min.css><style>pre{overflow-x:auto;padding:1rem;border-radius:3px;border:1px solid}code{font-size:1rem}</style></head><body class="sans-serif bg-near-white lh-copy"><main class="center w-100 mw7 pa3 mt5-l"><section class="flex flex-row-l flex-column-reverse"><article class="bb f5 w-100"><a href=https://thenomadcoder.com>Go Back</a><h1 class=ma0>Magento 2 Module Development with Pestle</h1><p>Magento 2 has a wide range of tools that help you with developing modules. One of the well-known CLI tools in Magento is <a href=https://github.com/netz98/n98-magerun2>Magerun</a>. This is an extension of Magento&rsquo;s own CLI tool that already comes out of the box when you install Magento 2. One of my favorite tools that I use a lot is <a href=https://github.com/astorm/pestle>Pestle by Alan Storm</a>.</p><p>Since much of our code we write mainly consists of template (reusable) code, Pestle helps to generate a lot of this code. Ultimately, this saves a lot of time when it comes to developing Magento 2 modules.</p><h2 id=what-is-pestle>What is Pestle</h2><p>You can think of Pestle as a PHP framework that helps you build and organize CLI programs in Magento 2. For example, you can extend existing functions such as the &ldquo;generate&rdquo; function with your own template.
Who is familiar with Python, Pestle is similar to how Python imports modules.
It is also a collection of CLI programs with a focus on Magento 2 code generation.</p><h2 id=install-pestle>Install Pestle</h2><p>Pestle comes in the form of a .phar file (PHP Archive file) and is easy to download as follows. Phar files are self-contained cross-platform, so it works on MacOS, Windows and Linux.</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash><span class=c1>#with curl:</span>
curl -LO http://pestle.pulsestorm.net/pestle.phar
<span class=c1>#with wget:</span>
wget http://pestle.pulsestorm.net/pestle.phar
</code></pre></div><p>Or you can download one of the other releases on their Github page.
Run the following &ldquo;php pestle.phar version&rdquo; to see which version is installed.</p><h2 id=what-are-we-going-to-build>What are we going to build?</h2><p>We are going to build a simple module with a front-end page that we can navigate to. After installing pestle, run &ldquo;php pestle.phar&rdquo; to see a list of options.</p><p>We are particularly interested in the Magento 2 Generate options. To see only the &ldquo;generate&rdquo; options run:</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>php pestle.phar <span class=p>|</span> grep generate --color<span class=o>=</span>never
</code></pre></div><h2 id=register-a-module>Register a module</h2><p>We start by registering a module. Now there are 2 options, the &ldquo;full-module&rdquo; and the &ldquo;module&rdquo; option.</p><p>The full module works slightly different from the module option. Instead of directly creating PHP and XML module files, this option generates a Unix shell script that executes other pestle commands to generate the module.</p><p>For now we stick to the &ldquo;module&rdquo; option. run:</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>php pestle.phar magento2:generate:module
</code></pre></div><p>Pestle will now come up with a few questions.</p><ul><li>What the vendor namespace should be</li><li>What the name of the module should be.</li><li>Which version. See as follows:</li></ul><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>www-data@example-php-fpm:04:51 PM:/var/www/html$ php pestle.phar magento2:generate:module
Vendor Namespace? <span class=o>(</span>Pulsestorm<span class=o>)]</span> Rick
Module Name? <span class=o>(</span>Testbed<span class=o>)]</span> Helloworld
Version? <span class=o>(</span>0.0.1<span class=o>)]</span> 
Creating <span class=o>[</span>/var/www/html/app/code/Rick/Helloworld/etc<span class=o>]</span> 
Created: /var/www/html/app/code/Rick/Helloworld/etc/module.xml
Created: /var/www/html/app/code/Rick/Helloworld/registration.php
</code></pre></div><p>After this is done you will see that under app/code/Rick a module HelloWorld has now been created. Run &ldquo;bin/magento s:up&rdquo; to register it.</p><figure class="mh0 mv3 w-100"><img class=w-100 alt="Pestle folder structure" srcset="/posts/magento-2-module-development-with-pestle/pestle-folder-structure_hube85adeabd1bf1d66143677542ab6bae_4074_458x0_resize_box_2.png 458w,
/posts/magento-2-module-development-with-pestle/pestle-folder-structure_hube85adeabd1bf1d66143677542ab6bae_4074_726x0_resize_box_2.png 726w,
/posts/magento-2-module-development-with-pestle/pestle-folder-structure_hube85adeabd1bf1d66143677542ab6bae_4074_1200x0_resize_box_2.png 1200w" sizes=50vw src=/posts/magento-2-module-development-with-pestle/pestle-folder-structure_hube85adeabd1bf1d66143677542ab6bae_4074_458x0_resize_box_2.png></figure><h2 id=create-a-front-end-route>Create a front-end route</h2><p>Now that we have created and installed a module, we can create a route.</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>php pestle.phar magento2:generate:route
</code></pre></div><p>Then you fill in the questions just as you did with generate: module.</p><ul><li>Choose in which module you want to create the route, in our case that is Rick_Helloworld</li><li>Choose whether it is a front-end or admin route, the default is front-end so just press enter.</li><li>The front-name and route id: rick_helloworld</li><li>Use default (Index) as &ldquo;Controller name&rdquo;</li><li>Use default (Index) as &ldquo;Action name&rdquo;</li></ul><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>www-data@example-php-fpm:04:51 PM:/var/www/html$ php pestle.phar magento2:generate:route 
Which Module? <span class=o>(</span>Pulsestorm_HelloWorld<span class=o>)]</span> Rick_Helloworld
Which Area <span class=o>(</span>frontend, adminhtml<span class=o>)</span>? <span class=o>(</span>frontend<span class=o>)]</span> 
Frontname/Route ID? <span class=o>(</span>pulsestorm_helloworld<span class=o>)]</span> rick_helloworld
Controller name? <span class=o>(</span>Index<span class=o>)]</span> 
Action name? <span class=o>(</span>Index<span class=o>)]</span> 
Backing existing file: /var/www/html/app/code/Rick/Helloworld/etc/frontend/routes.xml.5f1db51e071db.bak.php
/var/www/html/app/code/Rick/Helloworld/etc/frontend/routes.xml
/var/www/html/app/code/Rick/Helloworld/Controller/Index/Index.php
</code></pre></div><p>After you will see a routes.xml in <em>app/code/Rick/HelloWorld/etc/routes.xml</em></p><div class=highlight><pre class=chroma><code class=language-xml data-lang=xml><span class=ln>1</span><span class=cp>&lt;?xml version=&#34;1.0&#34;?&gt;</span>
<span class=ln>2</span><span class=nt>&lt;config</span> <span class=na>xmlns:xsi=</span><span class=s>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span> <span class=na>xsi:noNamespaceSchemaLocation=</span><span class=s>&#34;urn:magento:framework:App/etc/routes.xsd&#34;</span><span class=nt>&gt;</span>
<span class=ln>3</span>    <span class=nt>&lt;router</span> <span class=na>id=</span><span class=s>&#34;standard&#34;</span><span class=nt>&gt;</span>
<span class=ln>4</span>        <span class=nt>&lt;route</span> <span class=na>id=</span><span class=s>&#34;rick_helloworld&#34;</span> <span class=na>frontName=</span><span class=s>&#34;rick_helloworld&#34;</span><span class=nt>&gt;</span>
<span class=ln>5</span>            <span class=nt>&lt;module</span> <span class=na>name=</span><span class=s>&#34;Rick_Helloworld&#34;</span><span class=nt>/&gt;</span>
<span class=ln>6</span>        <span class=nt>&lt;/route&gt;</span>
<span class=ln>7</span>    <span class=nt>&lt;/router&gt;</span>
<span class=ln>8</span><span class=nt>&lt;/config&gt;</span>
</code></pre></div><p>If a routes.xml already exists, it will add a .bak extension, so that you keep a backup of your existing file. You can choose to remove it, if you no longer need it.</p><p>Finally, we create a front-end view by running:</p><pre><code>php pestle.phar magento2:generate:view
</code></pre><p>Choose &ldquo;Rick_Helloworld&rdquo; as the module and accept the default values for Area, Handle, Block Name, Template File and Layout. Eventually you will see that pestle creates the following files.</p><figure class="mh0 mv3 w-100"><img class=w-100 alt="Pestle folder structure 2" srcset="/posts/magento-2-module-development-with-pestle/pestle-folder-structure-2_huc7da2bd92a361611b0871157a561dd6e_12321_458x0_resize_box_2.png 458w,
/posts/magento-2-module-development-with-pestle/pestle-folder-structure-2_huc7da2bd92a361611b0871157a561dd6e_12321_726x0_resize_box_2.png 726w,
/posts/magento-2-module-development-with-pestle/pestle-folder-structure-2_huc7da2bd92a361611b0871157a561dd6e_12321_1200x0_resize_box_2.png 1200w" sizes=50vw src=/posts/magento-2-module-development-with-pestle/pestle-folder-structure-2_huc7da2bd92a361611b0871157a561dd6e_12321_458x0_resize_box_2.png></figure><p>Finally delete your cache with &ldquo;bin/magento c:c&rdquo; and go to https: //app.example.test/Rick_helloworld/index/index</p><figure class="mh0 mv3 w-100"><img class=w-100 alt="Pestle result" srcset="/posts/magento-2-module-development-with-pestle/pestle-result_hu3a01768593ff6d39bd8cb78407e7ea11_14372_458x0_resize_box_2.png 458w,
/posts/magento-2-module-development-with-pestle/pestle-result_hu3a01768593ff6d39bd8cb78407e7ea11_14372_726x0_resize_box_2.png 726w,
/posts/magento-2-module-development-with-pestle/pestle-result_hu3a01768593ff6d39bd8cb78407e7ea11_14372_1200x0_resize_box_2.png 1200w" sizes=50vw src=/posts/magento-2-module-development-with-pestle/pestle-result_hu3a01768593ff6d39bd8cb78407e7ea11_14372_458x0_resize_box_2.png></figure><p>As you can see, within a short time I created, registered & installed a Magento 2 module, built a controller, built a route.xml with a block, layout and template without writing any code. Pestle offers a wide range of options that help you develop Magento 2 modules, so I definitely recommend you to look at the other options that Pestle has to offer.</p><h2 id=useful-commands-in-pestle>Useful commands in Pestle</h2><p>In addition to generating code, it is also possible to perform scans and checks.</p><p>Corrects immediate use of PHP Object Manager</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>php pestle.phar magento2:fix-direct-om
</code></pre></div><p>Restores rights</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>php pestle.phar magento2:fix-permissions-mod
</code></pre></div><p>Scans modules for ACL rule IDs and ensures that they are all used / defined</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>php pestle.phar magento2:scan:acl-used
</code></pre></div><p>Searches for invalid keys in a MySQL database</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>php pestle.phar mysql:key-check
</code></pre></div><p>Migrating from Magento 1 code to Magento 2</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>php pestle.phar magento2:convert-class
php pestle.phar magento2:convert-observers-xml
php pestle.phar magento2:convert-system-xml
</code></pre></div></article></section><div class="list w-100"><h2 class="f3 mv3">Posts</h2><div class="f5 flex mb1 pa1 items-center dim"><time class="w-10 f6 fw4 mt0 mb0 black-60">11 Sep</time>
<a class="w-90 link black-90 f4" href=/posts/moving-from-sequel-pro-to-sequel-ace/>Moving from Sequel Pro to Sequel Ace</a></div><div class="f5 flex mb1 pa1 items-center dim"><time class="w-10 f6 fw4 mt0 mb0 black-60">4 Sep</time>
<a class="w-90 link black-90 f4" href=/posts/utilize-configuration-xml-and-variables-scope/>Utilize configuration XML and variables scope.</a></div><div class="f5 flex mb1 pa1 items-center dim"><time class="w-10 f6 fw4 mt0 mb0 black-60">19 Aug</time>
<a class="w-90 link black-90 f4" href=/posts/understanding-magento-2-module-based-architecture/>Understanding Magento 2 Module-Based Architecture</a></div><div class="f5 flex mb1 pa1 items-center dim"><time class="w-10 f6 fw4 mt0 mb0 black-60">4 Aug</time>
<a class="w-90 link black-90 f4" href=/posts/how-to-configure-a-magento-multi-store-in-docker/>How to Configure a Magento Multistore in Docker</a></div><div class="f5 flex mb1 pa1 items-center dim"><time class="w-10 f6 fw4 mt0 mb0 black-60">28 Jul</time>
<a class="w-90 link black-90 f4" href=/posts/how-to-setup-a-multistore-in-magento2/>How to Setup a Multistore in Magento 2</a></div><div class="f5 flex mb1 pa1 items-center dim"><time class="w-10 f6 fw4 mt0 mb0 black-60">21 Jul</time>
<a class="w-90 link black-90 f4" href=/posts/how-to-setup-a-magento-2-development-environment-with-docker/>How to Setup a Magento 2 Development Environment with Docker</a></div><div class="f5 flex mb1 pa1 items-center dim"><time class="w-10 f6 fw4 mt0 mb0 black-60">14 Jul</time>
<a class="w-90 link black-90 f4" href=/posts/jazz-up-your-zsh-terminal-with-prezto/>Jazz Up your ZSH Terminal with Prezto</a></div><div class="f5 flex mb1 pa1 items-center dim"><time class="w-10 f6 fw4 mt0 mb0 black-60">7 Jul</time>
<a class="w-90 link black-90 f4" href=/posts/setting-up-phpstorm-for-magento-2/>Setting up PhpStorm for Magento 2</a></div><div class="f5 flex mb1 pa1 items-center dim"><time class="w-10 f6 fw4 mt0 mb0 black-60">30 Jun</time>
<a class="w-90 link black-90 f4" href=/posts/declarative-schema-overview-in-magento2-part-2/>Declarative Schema Overview in Magento 2 - Part 2</a></div><div class="f5 flex mb1 pa1 items-center dim"><time class="w-10 f6 fw4 mt0 mb0 black-60">23 Jun</time>
<a class="w-90 link black-90 f4" href=/posts/declarative-schema-overview-in-magento2-part-1/>Declarative Schema Overview in Magento 2 - Part 1</a></div><div class="f5 flex mb1 pa1 items-center dim"><time class="w-10 f6 fw4 mt0 mb0 black-60">16 Jun</time>
<a class="w-90 link black-90 f4" href=/posts/magento-2-module-development-with-pestle/>Magento 2 Module Development with Pestle</a></div></div></main><footer class="pv4 ph3 ph5-m ph6-l mid-gray"><small class="f6 db tc">© 2016 <b class=ttu>Rick Daalhuizen</b>, All Rights Reserved</small></footer></body></html>