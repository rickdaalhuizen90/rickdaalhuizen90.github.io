<!doctype html><html><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>Rick Daalhuizen | Understanding Magento 2 Module-Based Architecture |</title><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=description content="Magento 2 Exam Series - Magento Architecture & Customization Techniques: What is a Magento 2 module and how does it work?"><meta name=generator content="Hugo 0.83.1"><meta property="og:site_name" content="Rick Daalhuizen"><meta property="og:url" content="https://thenomadcoder.com/posts/understanding-magento-2-module-based-architecture/"><meta property="og:locale" content="en-us"><meta property="og:locale:alternate" content="en_US"><meta property="og:country-name" content="Indonesia"><meta property="og:email" content><meta property="og:title" content="Understanding Magento 2 Module-Based Architecture"><meta property="og:type" content="article"><meta property="article:published_time" content="2020-08-19"><meta property="og:description" content="Magento 2 Exam Series - Magento Architecture & Customization Techniques: What is a Magento 2 module and how does it work?"><meta property="og:url" content="https://thenomadcoder.com/posts/understanding-magento-2-module-based-architecture/"><meta property="og:site_name" content="Rick Daalhuizen"><meta property="og:image" content="https://thenomadcoder.com/posts/understanding-magento-2-module-based-architecture/banner_huabfe6d0d5fed4477ac64098cb3650832_671307_1500x1500_fill_box_center_2.png"><meta property="og:image:alt" content="Understanding Magento 2 Module-Based Architecture"><meta property="og:tags" content="Magento 2"><meta property="twitter:description" content="Magento 2 Exam Series - Magento Architecture & Customization Techniques: What is a Magento 2 module and how does it work?"><meta property="twitter:title" content="Understanding Magento 2 Module-Based Architecture"><meta property="twitter:image" content="https://thenomadcoder.com/posts/understanding-magento-2-module-based-architecture/banner_huabfe6d0d5fed4477ac64098cb3650832_671307_1500x1500_fill_box_center_2.png"><meta name=google-site-verification content><meta name=application-name content="Rick Daalhuizen"><meta name=mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="black"><meta name=apple-mobile-web-app-title content="Rick Daalhuizen"><link rel=icon sizes=16x16 href=favicon-16x16.png><link rel=icon sizes=32x32 href=favicon-32x32.png><link rel=icon sizes=192x192 href=android-chrome-192x192.png><link rel=icon sizes=512x512 href=android-chrome-512x512.png><link rel=apple-touch-icon href=apple-touch-icon.png><meta name=msapplication-TileColor content="#ff0000"><meta name=theme-color content="#ff0000"><link rel=author href=https://thenomadcoder.com/humans.txt><link rel=copyright href=https://thenomadcoder.com/copyright.html><meta name=monetization content="$ilp.uphold.com/PMDha7R3yZgG"><link href=https://thenomadcoder.com/index.xml rel=alternate type=application/rss+xml title="Rick Daalhuizen"><link rel=stylesheet href=https://unpkg.com/tachyons@4.12.0/css/tachyons.min.css><style>pre{overflow-x:auto;padding:1rem;border-radius:3px;box-shadow:inset 0 0 0 1px rgb(0 0 0/5%),0 2px 2px -1px rgb(0 0 0/.2)}code{font-size:1rem}</style></head><body class="sans-serif bg-near-white lh-copy"><main class="center w-100 mw7 pa2 mt5-l"><section class="flex flex-row-l flex-column-reverse"><article class="bb f5 w-100 w-75-l"><a href=https://thenomadcoder.com>Go Back</a><h1 class=ma0>Understanding Magento 2 Module-Based Architecture</h1><p>Let&rsquo;s start with what a module is, how a module works and how we can register it.</p><h2 id=module-overview>Module overview</h2><p>The Magento 2 documentation explains the following about modules:</p><blockquote cite=http://example.com/facts class="mh0 mv3 pa3 bg-washed-blue outline shadow-1"><p>A module is a logical group – that is, a directory containing blocks, controllers, helpers, models – that are related to a specific business feature. In keeping with Magento’s commitment to optimal modularity, a module encapsulates one feature and has minimal dependencies on other modules. - <a href>Magento DevDocs - Module overview</a></p></blockquote><blockquote cite=http://example.com/facts class="mh0 mv3 pa3 bg-washed-blue outline shadow-1"><p>Modules and themes are the units of customization in Magento. Modules provide business features, with supporting logic, while themes strongly influence user experience and storefront appearance. Both components have a life cycle that allows them to be installed, deleted, and disabled. From the perspective of both merchants and extension developers, modules are the central unit of Magento organization. - <a href>Magento DevDocs - Module overview</a></p></blockquote><blockquote cite=http://example.com/facts class="mh0 mv3 pa3 bg-washed-blue outline shadow-1"><p>The Magento Framework provides a set of core logic: PHP code, libraries, and the basic functions that are inherited by the modules and other components. - <a href>Magento DevDocs - Module overview</a></p></blockquote><p>In short: a module is a logic group (folder) that contains business logic for a specific feature. A module can be installed in 2 places.</p><ol><li>In vendor (when installed with composer): <em>vendor/[vendor]/[type]/[type]-[module-name]/[module-name]</em>.</li><li>In app/ (without composer):<ul><li>as module: <em>app/code/[VendorName]/[ModuleName]</em></li><li>as theme: <em>app/design/[type]/[VendorName]/[ThemeName]</em></li><li>as language pack: <em>app/i18n/en_EN.csv</em></li></ul></li></ol><p>When we talk about “type”, we are talking about a module, theme (admin or frontend themes) or language pack.</p><p>If a module contains a specific customization that is only related to a specific project, we can put it in <em>app/code/[vendor]/[type]-[module-name]</em>.</p><p>It&rsquo;s common to develop our module first in app/ and move it into vendor when a first &ldquo;stable&rdquo; release is ready.</p><h2 id=module-registration>Module registration</h2><p>Magento components, including modules, themes, and language packages, must be registered in the Magento system through the Magento ComponentRegistrar class. - <a href>Magento DevDocs - Register your component</a></p><p>When we build a module, it must be registered in order to be recognized by Magento. This is done by means of the Magento <a href=https://github.com/magento/magento2/blob/2.4-develop/lib/internal/Magento/Framework/Component/ComponentRegistrar.php>ComponentRegistrar class</a> in <em>registration.php</em>. You create this in the root of your module.</p><ul><li>Register a module</li></ul><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-php data-lang=php><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
<span style=color:#66d9ef>use</span> <span style=color:#a6e22e>\Magento\Framework\Component\ComponentRegistrar</span>;
<span style=color:#a6e22e>ComponentRegistrar</span><span style=color:#f92672>::</span><span style=color:#a6e22e>register</span>(<span style=color:#a6e22e>ComponentRegistrar</span><span style=color:#f92672>::</span><span style=color:#a6e22e>MODULE</span>, <span style=color:#e6db74>&#39;[Vendor_ModuleName]&#39;</span>, <span style=color:#66d9ef>__DIR__</span>);
</code></pre></div><ul><li>Register a language pack</li></ul><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-php data-lang=php><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
<span style=color:#66d9ef>use</span> <span style=color:#a6e22e>\Magento\Framework\Component\ComponentRegistrar</span>;
<span style=color:#a6e22e>ComponentRegistrar</span><span style=color:#f92672>::</span><span style=color:#a6e22e>register</span>(<span style=color:#a6e22e>ComponentRegistrar</span><span style=color:#f92672>::</span><span style=color:#a6e22e>LANGUAGE</span>, <span style=color:#960050;background-color:#1e0010>&#39;</span>[<span style=color:#a6e22e>Vendor_PackageName</span>], <span style=color:#66d9ef>__DIR__</span>);
</code></pre></div><ul><li>Register a Frontend or Admin theme, where <em>[area]</em> is frontend or adminhtml.</li></ul><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-php data-lang=php><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
<span style=color:#66d9ef>use</span> <span style=color:#a6e22e>\Magento\Framework\Component\ComponentRegistrar</span>;
<span style=color:#a6e22e>ComponentRegistrar</span><span style=color:#f92672>::</span><span style=color:#a6e22e>register</span>(<span style=color:#a6e22e>ComponentRegistrar</span><span style=color:#f92672>::</span><span style=color:#a6e22e>THEME</span>, <span style=color:#960050;background-color:#1e0010>&#39;</span>[<span style=color:#a6e22e>area</span>]<span style=color:#f92672>/</span>[<span style=color:#a6e22e>vendor</span>]<span style=color:#f92672>/</span>[<span style=color:#a6e22e>theme</span><span style=color:#f92672>-</span><span style=color:#a6e22e>name</span>], <span style=color:#66d9ef>__DIR__</span>);
</code></pre></div><p>Then we have to autoload our registration.php in /composer.json (root of your module).</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-json data-lang=json>{
    <span style=color:#f92672>&#34;name&#34;</span>: [<span style=color:#960050;background-color:#1e0010>vendor</span>]<span style=color:#960050;background-color:#1e0010>/</span>[<span style=color:#960050;background-color:#1e0010>module-name</span>]
    <span style=color:#e6db74>&#34;autoload&#34;</span> {
        <span style=color:#f92672>&#34;psr-4&#34;</span>: { <span style=color:#f92672>&#34;[Vendor]\\[ModuleName]\\&#34;</span>: <span style=color:#e6db74>&#34;&#34;</span> },
        <span style=color:#f92672>&#34;files&#34;</span>: [<span style=color:#e6db74>&#34;registration.php&#34;</span>]
    }
}
</code></pre></div><p>After we&rsquo;ve created our registration.php and added this to our composer autoload, we need to create a <em>/etc/module.xml</em>.
It basically tells Magento that it exsist.</p><p>The sequence nodes describes the order that the module has to load. This might be usefull when you&rsquo;re working with plugins, preferences or other dependencies such as layouts.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-xml data-lang=xml><span style=color:#75715e>&lt;?xml version=&#34;1.0&#34;?&gt;</span>
<span style=color:#f92672>&lt;config</span> <span style=color:#a6e22e>xmlns:xsi=</span><span style=color:#e6db74>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
        <span style=color:#a6e22e>xsi:noNamespaceSchemaLocation=</span><span style=color:#e6db74>&#34;urn:magento:framework:Module/etc/module.xsd&#34;</span><span style=color:#f92672>&gt;</span>
    <span style=color:#f92672>&lt;module</span> <span style=color:#a6e22e>name=</span><span style=color:#e6db74>&#34;YourCompany_YourModule&#34;</span> <span style=color:#a6e22e>setup_version=</span><span style=color:#e6db74>&#34;1.0.0&#34;</span><span style=color:#f92672>&gt;</span>
        <span style=color:#f92672>&lt;sequence&gt;</span>
            <span style=color:#f92672>&lt;module</span> <span style=color:#a6e22e>name=</span><span style=color:#e6db74>&#34;TheirCompany_TheirModule&#34;</span> <span style=color:#f92672>/&gt;</span>
            <span style=color:#f92672>&lt;module</span> <span style=color:#a6e22e>name=</span><span style=color:#e6db74>&#34;AnotherCompany_AnotherModule&#34;</span> <span style=color:#f92672>/&gt;</span>
        <span style=color:#f92672>&lt;/sequence&gt;</span>
    <span style=color:#f92672>&lt;/module&gt;</span>
<span style=color:#f92672>&lt;/config&gt;</span>
</code></pre></div><h2 id=modules-interaction>Modules interaction</h2><p>The way modules in Magento 2 interact with each other is by means of dependency injection, <a href>Service Contracts</a> or <a href>Data Service Contracts</a>. An important aspect of interaction is the scope in which the component is located. In other words, a Magento area.</p><p>Some benefits of using service contracts is that these contracts ensure a well-defined, durable API that other modules and third-party extensions can implement. Also, these contracts make it easy to configure services as web APIs.</p><p>Magento docs: <a href=https://devdocs.magento.com/guides/v2.2/architecture/archi_perspectives/service_layer.html#service-contract-anatomy>Service contract anatomy</a></p><h2 id=modules-limitation-and-side-effects>Modules limitation and side effects</h2><p>However, there&rsquo;re some limitations and should be considered when you&rsquo;re working with modules in Magento 2.
You should use depends to indicate that a module depends on another module - <a href=https://devdocs.magento.com/guides/v2.4/architecture/archi_perspectives/components/modules/mod_depend.html>Module dependencies</a></p><ol><li>A module is responsible for 1 feature.</li><li>A module that is dependent on other modules must be explicitly stated in <em>etc/modules.xml</em>, using depends.</li><li>When a module is installed or removed it should have no effect on other modules.</li></ol><p>Some common errors are:</p><ul><li><a href=https://laracasts.com/discuss/channels/laravel/reflectionexception-class-not-found-on-repository>Missing Class ReflectionException</a></li><li><a href=https://stackoverflow.com/questions/31364289/error-class-does-not-exist>Class MissingClass does not exist</a></li><li><a href=https://dev.to/dechamp/php---how-to-fix-class--not-found-error-1gp9>PHP Warning: Uncaught Error: Class MissingClass not found</a></li></ul><h2 id=magento-areas>Magento areas</h2><p>A Magento area only loads the components that are related to that area. When a component is loaded, you only need to look at the area where the request takes place. This ensures a more optimized process. In addition, it ensures that a component cannot influence different areas.</p><blockquote cite=http://example.com/facts class="mh0 mv3 pa3 bg-washed-blue outline shadow-1"><p>You can enable or disable an area within a module. If this module is enabled, it injects an area’s routers into the general application’s routing process. If this module is disabled, Magento will not load an area’s routers and, as a result, an area’s resources and specific functionality are not available.
&ndash; <a href>Magento DevDocs - Modules and areas</a></p></blockquote><h2 id=magento-area-types>Magento area types</h2><ol><li><strong>Adminhtml</strong> - Any code you see in the admin panel</li><li><strong>Frontend</strong> - The storefront (or frontend) has all the template and layout files that you see on the front.</li><li><strong>Base</strong> - This is the fallback when there is no adminhtml or frontend area.</li><li><strong>Crontab</strong> - Located in cron.php and loaded with <em>\Magento\Framework\App\Cron</em>.</li><li><strong>webapi_rest</strong> - Used for REST APIs</li><li><strong>webapi_soap</strong> - Used for SOAP APIs</li></ol><p>To see how areas work, you can find the code <a href=https://github.com/magento/magento2/blob/2.0/lib/internal/Magento/Framework/App/Area.php>Magento/Framework/App/Area.php</a></p></article><aside class=w-25-l><div class=toc><nav id=TableOfContents><ul><li><a href=#module-overview>Module overview</a></li><li><a href=#module-registration>Module registration</a></li><li><a href=#modules-interaction>Modules interaction</a></li><li><a href=#modules-limitation-and-side-effects>Modules limitation and side effects</a></li><li><a href=#magento-areas>Magento areas</a></li><li><a href=#magento-area-types>Magento area types</a></li></ul></nav></div></aside></section><div class="list w-100"><h2 class="f3 mv3">Posts</h2><div class="f5 flex mb1 pa1 items-center dim"><time class="w-10 f6 fw4 mt0 mb0 black-60">11 Sep</time>
<a class="w-90 link black-90 f4" href=/posts/moving-from-sequel-pro-to-sequel-ace/>Moving from Sequel Pro to Sequel Ace</a></div><div class="f5 flex mb1 pa1 items-center dim"><time class="w-10 f6 fw4 mt0 mb0 black-60">4 Sep</time>
<a class="w-90 link black-90 f4" href=/posts/utilize-configuration-xml-and-variables-scope/>Utilize configuration XML and variables scope.</a></div><div class="f5 flex mb1 pa1 items-center dim"><time class="w-10 f6 fw4 mt0 mb0 black-60">19 Aug</time>
<a class="w-90 link black-90 f4" href=/posts/understanding-magento-2-module-based-architecture/>Understanding Magento 2 Module-Based Architecture</a></div><div class="f5 flex mb1 pa1 items-center dim"><time class="w-10 f6 fw4 mt0 mb0 black-60">4 Aug</time>
<a class="w-90 link black-90 f4" href=/posts/how-to-configure-a-magento-multi-store-in-docker/>How to Configure a Magento Multistore in Docker</a></div><div class="f5 flex mb1 pa1 items-center dim"><time class="w-10 f6 fw4 mt0 mb0 black-60">28 Jul</time>
<a class="w-90 link black-90 f4" href=/posts/how-to-setup-a-multistore-in-magento2/>How to Setup a Multistore in Magento 2</a></div><div class="f5 flex mb1 pa1 items-center dim"><time class="w-10 f6 fw4 mt0 mb0 black-60">21 Jul</time>
<a class="w-90 link black-90 f4" href=/posts/how-to-setup-a-magento-2-development-environment-with-docker/>How to Setup a Magento 2 Development Environment with Docker</a></div><div class="f5 flex mb1 pa1 items-center dim"><time class="w-10 f6 fw4 mt0 mb0 black-60">14 Jul</time>
<a class="w-90 link black-90 f4" href=/posts/jazz-up-your-zsh-terminal-with-prezto/>Jazz Up your ZSH Terminal with Prezto</a></div><div class="f5 flex mb1 pa1 items-center dim"><time class="w-10 f6 fw4 mt0 mb0 black-60">7 Jul</time>
<a class="w-90 link black-90 f4" href=/posts/setting-up-phpstorm-for-magento-2/>Setting up PhpStorm for Magento 2</a></div><div class="f5 flex mb1 pa1 items-center dim"><time class="w-10 f6 fw4 mt0 mb0 black-60">30 Jun</time>
<a class="w-90 link black-90 f4" href=/posts/declarative-schema-overview-in-magento2-part-2/>Declarative Schema Overview in Magento 2 - Part 2</a></div><div class="f5 flex mb1 pa1 items-center dim"><time class="w-10 f6 fw4 mt0 mb0 black-60">23 Jun</time>
<a class="w-90 link black-90 f4" href=/posts/declarative-schema-overview-in-magento2-part-1/>Declarative Schema Overview in Magento 2 - Part 1</a></div><div class="f5 flex mb1 pa1 items-center dim"><time class="w-10 f6 fw4 mt0 mb0 black-60">16 Jun</time>
<a class="w-90 link black-90 f4" href=/posts/magento-2-module-development-with-pestle/>Magento 2 Module Development with Pestle</a></div></div></main><footer class="pv4 ph3 ph5-m ph6-l mid-gray"><small class="f6 db tc">© 2016 <b class=ttu>Rick Daalhuizen</b>, All Rights Reserved</small></footer></body></html>