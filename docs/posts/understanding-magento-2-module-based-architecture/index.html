<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><title>Understanding Magento 2 Module-Based Architecture - Rick Daalhuizen</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel=icon href=https://rickdaalhuizen.comfavicon.png><link rel=stylesheet href=/css/style.min.4b2bfb3701049fe0da3e8d6b9d15186ba1dc7e294f0be3e2bca21bb8a330f5dd.css><meta name=description content="Magento 2 Exam Series - Magento Architecture & Customization Techniques: What is a Magento 2 module and how does it work?"><meta property="og:title" content="Understanding Magento 2 Module-Based Architecture"><meta property="og:type" content="website"><meta property="og:url" content="https://rickdaalhuizen.com/posts/understanding-magento-2-module-based-architecture/"><meta property="og:description" content="Magento 2 Exam Series - Magento Architecture & Customization Techniques: What is a Magento 2 module and how does it work?"><meta name=twitter:card content="summary"><meta name=twitter:site content="@zerostaticio"><meta name=twitter:creator content="@zerostaticio"><link rel=preconnect href=https://fonts.gstatic.com><link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap" rel=stylesheet></head><body class="page page-default-single"><div id=wrapper class=wrapper><div class=header><a class=header-logo href=https://rickdaalhuizen.com>Rick Daalhuizen</a><div class=menu-main><ul><li class=menu-item-about><a href=/pages/about/>About</a></li><li class=menu-item-posts><a href=/posts/>Posts</a></li></ul></div></div><div class=intro><h1>Understanding Magento 2 Module-Based Architecture<span class=dot>.</span></h1></div><div class=content><p>Let&rsquo;s start with what a module is, how a module works and how we can register it.</p><h2 id=module-overview>Module overview</h2><p>The Magento 2 documentation explains the following about modules:</p><blockquote><p>A module is a logical group – that is, a directory containing blocks, controllers, helpers, models – that are related to a specific business feature. In keeping with Magento’s commitment to optimal modularity, a module encapsulates one feature and has minimal dependencies on other modules. - <a href>Magento DevDocs - Module overview</a></p></blockquote><blockquote><p>Modules and themes are the units of customization in Magento. Modules provide business features, with supporting logic, while themes strongly influence user experience and storefront appearance. Both components have a life cycle that allows them to be installed, deleted, and disabled. From the perspective of both merchants and extension developers, modules are the central unit of Magento organization. - <a href>Magento DevDocs - Module overview</a></p></blockquote><blockquote><p>The Magento Framework provides a set of core logic: PHP code, libraries, and the basic functions that are inherited by the modules and other components. - <a href>Magento DevDocs - Module overview</a></p></blockquote><p>In short: a module is a logic group (folder) that contains business logic for a specific feature. A module can be installed in 2 places.</p><ol><li>In vendor (when installed with composer): <em>vendor/[vendor]/[type]/[type]-[module-name]/[module-name]</em>.</li><li>In app/ (without composer):<ul><li>as module: <em>app/code/[VendorName]/[ModuleName]</em></li><li>as theme: <em>app/design/[type]/[VendorName]/[ThemeName]</em></li><li>as language pack: <em>app/i18n/en_EN.csv</em></li></ul></li></ol><p>When we talk about “type”, we are talking about a module, theme (admin or frontend themes) or language pack.</p><p>If a module contains a specific customization that is only related to a specific project, we can put it in <em>app/code/[vendor]/[type]-[module-name]</em>.</p><p>It&rsquo;s common to develop our module first in app/ and move it into vendor when a first &ldquo;stable&rdquo; release is ready.</p><h2 id=module-registration>Module registration</h2><p>Magento components, including modules, themes, and language packages, must be registered in the Magento system through the Magento ComponentRegistrar class. - <a href>Magento DevDocs - Register your component</a></p><p>When we build a module, it must be registered in order to be recognized by Magento. This is done by means of the Magento <a href=https://github.com/magento/magento2/blob/2.4-develop/lib/internal/Magento/Framework/Component/ComponentRegistrar.php>ComponentRegistrar class</a> in <em>registration.php</em>. You create this in the root of your module.</p><ul><li>Register a module</li></ul><div class=highlight><pre class=chroma><code class=language-php data-lang=php><span class=o>&lt;?</span><span class=nx>php</span>
<span class=k>use</span> <span class=nx>\Magento\Framework\Component\ComponentRegistrar</span><span class=p>;</span>
<span class=nx>ComponentRegistrar</span><span class=o>::</span><span class=na>register</span><span class=p>(</span><span class=nx>ComponentRegistrar</span><span class=o>::</span><span class=na>MODULE</span><span class=p>,</span> <span class=s1>&#39;[Vendor_ModuleName]&#39;</span><span class=p>,</span> <span class=no>__DIR__</span><span class=p>);</span>
</code></pre></div><ul><li>Register a language pack</li></ul><div class=highlight><pre class=chroma><code class=language-php data-lang=php><span class=o>&lt;?</span><span class=nx>php</span>
<span class=k>use</span> <span class=nx>\Magento\Framework\Component\ComponentRegistrar</span><span class=p>;</span>
<span class=nx>ComponentRegistrar</span><span class=o>::</span><span class=na>register</span><span class=p>(</span><span class=nx>ComponentRegistrar</span><span class=o>::</span><span class=na>LANGUAGE</span><span class=p>,</span> <span class=err>&#39;</span><span class=p>[</span><span class=nx>Vendor_PackageName</span><span class=p>],</span> <span class=no>__DIR__</span><span class=p>);</span>
</code></pre></div><ul><li>Register a Frontend or Admin theme, where <em>[area]</em> is frontend or adminhtml.</li></ul><div class=highlight><pre class=chroma><code class=language-php data-lang=php><span class=o>&lt;?</span><span class=nx>php</span>
<span class=k>use</span> <span class=nx>\Magento\Framework\Component\ComponentRegistrar</span><span class=p>;</span>
<span class=nx>ComponentRegistrar</span><span class=o>::</span><span class=na>register</span><span class=p>(</span><span class=nx>ComponentRegistrar</span><span class=o>::</span><span class=na>THEME</span><span class=p>,</span> <span class=err>&#39;</span><span class=p>[</span><span class=nx>area</span><span class=p>]</span><span class=o>/</span><span class=p>[</span><span class=nx>vendor</span><span class=p>]</span><span class=o>/</span><span class=p>[</span><span class=nx>theme</span><span class=o>-</span><span class=nx>name</span><span class=p>],</span> <span class=no>__DIR__</span><span class=p>);</span>
</code></pre></div><p>Then we have to autoload our registration.php in /composer.json (root of your module).</p><div class=highlight><pre class=chroma><code class=language-json data-lang=json><span class=p>{</span>
    <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=p>[</span><span class=err>vendor</span><span class=p>]</span><span class=err>/</span><span class=p>[</span><span class=err>module-name</span><span class=p>]</span>
    <span class=s2>&#34;autoload&#34;</span> <span class=p>{</span>
        <span class=nt>&#34;psr-4&#34;</span><span class=p>:</span> <span class=p>{</span> <span class=nt>&#34;[Vendor]\\[ModuleName]\\&#34;</span><span class=p>:</span> <span class=s2>&#34;&#34;</span> <span class=p>},</span>
        <span class=nt>&#34;files&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;registration.php&#34;</span><span class=p>]</span>
    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div><p>After we&rsquo;ve created our registration.php and added this to our composer autoload, we need to create a <em>/etc/module.xml</em>.
It basically tells Magento that it exsist.</p><p>The sequence nodes describes the order that the module has to load. This might be usefull when you&rsquo;re working with plugins, preferences or other dependencies such as layouts.</p><div class=highlight><pre class=chroma><code class=language-xml data-lang=xml><span class=cp>&lt;?xml version=&#34;1.0&#34;?&gt;</span>
<span class=nt>&lt;config</span> <span class=na>xmlns:xsi=</span><span class=s>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
        <span class=na>xsi:noNamespaceSchemaLocation=</span><span class=s>&#34;urn:magento:framework:Module/etc/module.xsd&#34;</span><span class=nt>&gt;</span>
    <span class=nt>&lt;module</span> <span class=na>name=</span><span class=s>&#34;YourCompany_YourModule&#34;</span> <span class=na>setup_version=</span><span class=s>&#34;1.0.0&#34;</span><span class=nt>&gt;</span>
        <span class=nt>&lt;sequence&gt;</span>
            <span class=nt>&lt;module</span> <span class=na>name=</span><span class=s>&#34;TheirCompany_TheirModule&#34;</span> <span class=nt>/&gt;</span>
            <span class=nt>&lt;module</span> <span class=na>name=</span><span class=s>&#34;AnotherCompany_AnotherModule&#34;</span> <span class=nt>/&gt;</span>
        <span class=nt>&lt;/sequence&gt;</span>
    <span class=nt>&lt;/module&gt;</span>
<span class=nt>&lt;/config&gt;</span>
</code></pre></div><h2 id=modules-interaction>Modules interaction</h2><p>The way modules in Magento 2 interact with each other is by means of dependency injection, <a href>Service Contracts</a> or <a href>Data Service Contracts</a>. An important aspect of interaction is the scope in which the component is located. In other words, a Magento area.</p><p>Some benefits of using service contracts is that these contracts ensure a well-defined, durable API that other modules and third-party extensions can implement. Also, these contracts make it easy to configure services as web APIs.</p><p>Magento docs: <a href=https://devdocs.magento.com/guides/v2.2/architecture/archi_perspectives/service_layer.html#service-contract-anatomy>Service contract anatomy</a></p><h2 id=modules-limitation-and-side-effects>Modules limitation and side effects</h2><p>However, there&rsquo;re some limitations and should be considered when you&rsquo;re working with modules in Magento 2.
You should use depends to indicate that a module depends on another module - <a href=https://devdocs.magento.com/guides/v2.4/architecture/archi_perspectives/components/modules/mod_depend.html>Module dependencies</a></p><ol><li>A module is responsible for 1 feature.</li><li>A module that is dependent on other modules must be explicitly stated in <em>etc/modules.xml</em>, using depends.</li><li>When a module is installed or removed it should have no effect on other modules.</li></ol><p>Some common errors are:</p><ul><li><a href=https://laracasts.com/discuss/channels/laravel/reflectionexception-class-not-found-on-repository>Missing Class ReflectionException</a></li><li><a href=https://stackoverflow.com/questions/31364289/error-class-does-not-exist>Class MissingClass does not exist</a></li><li><a href=https://dev.to/dechamp/php---how-to-fix-class--not-found-error-1gp9>PHP Warning: Uncaught Error: Class MissingClass not found</a></li></ul><h2 id=magento-areas>Magento areas</h2><p>A Magento area only loads the components that are related to that area. When a component is loaded, you only need to look at the area where the request takes place. This ensures a more optimized process. In addition, it ensures that a component cannot influence different areas.</p><blockquote><p>You can enable or disable an area within a module. If this module is enabled, it injects an area’s routers into the general application’s routing process. If this module is disabled, Magento will not load an area’s routers and, as a result, an area’s resources and specific functionality are not available.
&ndash; <a href>Magento DevDocs - Modules and areas</a></p></blockquote><h2 id=magento-area-types>Magento area types</h2><ol><li><strong>Adminhtml</strong> - Any code you see in the admin panel</li><li><strong>Frontend</strong> - The storefront (or frontend) has all the template and layout files that you see on the front.</li><li><strong>Base</strong> - This is the fallback when there is no adminhtml or frontend area.</li><li><strong>Crontab</strong> - Located in cron.php and loaded with <em>\Magento\Framework\App\Cron</em>.</li><li><strong>webapi_rest</strong> - Used for REST APIs</li><li><strong>webapi_soap</strong> - Used for SOAP APIs</li></ol><p>To see how areas work, you can find the code <a href=https://github.com/magento/magento2/blob/2.0/lib/internal/Magento/Framework/App/Area.php>Magento/Framework/App/Area.php</a></p></div><div class=footer><div class=footer-social><span class="social-icon social-icon-twitter"><a href=https://twitter.com/zerostaticio title=twitter target=_blank rel=noopener><img src=/images/social/twitter.svg width=24 height=24 alt=twitter></a></span>
<span class="social-icon social-icon-github"><a href=https://github.com/zerostaticthemes title=github target=_blank rel=noopener><img src=/images/social/github.svg width=24 height=24 alt=github></a></span>
<span class="social-icon social-icon-linkedin"><a href=https://www.linkedin.com title=linkedin target=_blank rel=noopener><img src=/images/social/linkedin.svg width=24 height=24 alt=linkedin></a></span></div></div></div><script type=text/javascript src=/js/bundle.min.e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855.js></script></body></html>