<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><title>Utilize configuration XML and variables scope. - Rick Daalhuizen</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel=icon href=https://rickdaalhuizen.comfavicon.png><link rel=stylesheet href=/css/style.min.4b2bfb3701049fe0da3e8d6b9d15186ba1dc7e294f0be3e2bca21bb8a330f5dd.css><meta name=description content="Magento 2 Exam Series - Magento Architecture & Customization Techniques: Determine how to use configuration files in Magento."><meta property="og:title" content="Utilize configuration XML and variables scope."><meta property="og:type" content="website"><meta property="og:url" content="https://rickdaalhuizen.com/posts/utilize-configuration-xml-and-variables-scope/"><meta property="og:description" content="Magento 2 Exam Series - Magento Architecture & Customization Techniques: Determine how to use configuration files in Magento."><meta name=twitter:card content="summary"><meta name=twitter:site content="@zerostaticio"><meta name=twitter:creator content="@zerostaticio"><link rel=preconnect href=https://fonts.gstatic.com><link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap" rel=stylesheet></head><body class="page page-default-single"><div id=wrapper class=wrapper><div class=header><a class=header-logo href=https://rickdaalhuizen.com>Rick Daalhuizen</a><div class=menu-main><ul><li class=menu-item-about><a href=/pages/about/>About</a></li><li class=menu-item-posts><a href=/posts/>Posts</a></li></ul></div></div><div class=intro><h1>Utilize configuration XML and variables scope.<span class=dot>.</span></h1></div><div class=content><p>Much of the configuration in Magento 2 is done by xml files, and placed in the <em>[Module_Root]/etc/</em> directory.
Depending on the <strong>scope</strong> of your configuration, place them in <em>etc/adminhtml</em>, <em>etc/frontend</em> or under <strong>global scope</strong> under <em>etc/</em>. When you put them in adminhtml or frontend, this overwrites the global scope.</p><h2 id=list-of-xml-config-files>List of XML config files.</h2><ul><li><em>acl.xml</em> - resource title, sort</li><li><em>adminhtml/rules/payment_{country}.xml</em> - paypal</li><li><em>address_formats.xml</em></li><li><em>address_types.xml</em> - format code and title only</li><li><em>cache.xml</em> - name, instance - e.g. full_page=Page Cache</li><li><em>catalog_attributes.xml</em> - catalog_category, catalog_product, unassignable, used_in_autogeneration, quote_item *</li><li><em>communication.xml</em></li><li><em>config.xml</em> - defaults</li><li><em>crontab.xml</em> - group[], job instance, method, schedule *</li><li><em>cron_groups.xml</em> *</li><li><em>di.xml</em> - preference, plugins, virtual type *</li><li><em>eav_attributes.xml</em> - locked entity attributes (global, unique etc.)</li><li><em>email_templates.xml</em> - id label file type module &ndash; view/frontend/email/name.html</li><li><em>events.xml</em> - observers, shared, disabled *</li><li><em>export.xml</em></li><li><em>extension_attributes.xml</em> - for, attribute code, attribute type</li><li><em>fieldset.xml</em></li><li><em>import.xml</em></li><li><em>indexer.xml</em> - class, view_id, title, description</li><li><em>integration.xml</em></li><li><em>integration/api.xml</em></li><li><em>integration/config.xml</em></li><li><em>menu.xml</em> - admin menu</li><li><em>module.xml</em> - version, sequence</li><li><em>mview.xml</em> - scheduled updates, subscribe to table changes, indexer model</li><li><em>page_types.xml</em></li><li><em>payment.xml</em> - groups, method allow_multiple_address</li><li><em>pdf.xml</em> - renders by type (invoice, shipment, creditmemo) and product type</li><li><em>product_types.xml</em> - label, model instance, index priority, (?) custom attributes, (!) composable types</li><li><em>product_options.xml</em></li><li><em>resources.xml</em></li><li><em>routes.xml</em></li><li><em>sales.xml</em> - collectors (quote, order, invoice, credit memo)</li><li><em>search_engine.xml</em></li><li><em>search_request.xml</em> - index, dimensions, queries, filters, aggregations, buckets</li><li><em>sections.xml</em> - action route placeholder -> invalidate customer sections</li><li><em>system.xml</em> - adminhtml config</li><li><em>validation.xml</em> - entity, rules, constraints -> class</li><li><em>view.xml</em> - vars by module</li><li><em>webapi.xml</em> - route, method, service class and method, resources</li><li><em>widget.xml</em> - class, email compatible, image, ttl (?), label, description, parameters</li><li><em>zip_codes.xml</em> - <a href=https://devdocs.magento.com/guides/v2.3/howdoi/checkout/checkout_zip.html>Add custom input mask for ZIP code</a></li></ul><h2 id=configuration-load-order>Configuration load order</h2><p>The load order of the configuration files start with <em>app/etc/di.xml</em>.First it&rsquo;s collecting configration files under <em>[Module_Root]etc/*.xml</em>, then under <em>[Module_Root]/etc/[Area]/*.xml</em>, and finally merges them together.</p><p>While merging the configuration files, it is checked whether the id attribute of an xml node is unique, otherwise it will be overwritten with all underlying content (child nodes).</p><p>When the same xml document (configuration file) contains multiple nodes with the same id, it will give an error. &ndash; <a href=https://devdocs.magento.com/guides/v2.2/config-guide/config/config-files.html>Magento DevDocs - Module configuration files</a></p><ol><li><strong>Config merger class</strong><ul><li>\Magento\Framework\Config\Dom</li></ul></li><li><strong>When merging each file</strong><ul><li>createConfigMerger|merge</li><li>\Magento\Framework\Config\Dom::_initDom(dom, perFileSchema)</li><li>\Magento\Framework\Config\Dom::validateDomDocument</li><li>$dom->schemaValidate</li></ul></li><li><strong>After everything is merged</strong><ul><li>\Magento\Framework\Config\Dom::validate(mergedSchema)</li><li>\Magento\Framework\Config\Dom::validateDomDocument</li></ul></li></ol><h2 id=environment-settings>Environment settings</h2><p>Magento 2 comes with a configuration file <em>app/etc/env.php</em> where you can store system-specific but also sensitive files, these can be API keys, passwords and personal information e.g. email or phone number. Sensitive data is not included during the export.</p><p>This file also contains your db data, crypt key to protect your passwords and other sensitive information (created during the Magento installation), backend frontName for your admin url and cache types.</p><p>To create a configuration you can do this as follows with <em>bin/magento</em>.</p><blockquote><p>To see more options run <em>bin/magento config</em>, options for <strong>Magento 2.2.4 or higher</strong> may differ.</p></blockquote><p>Set non-sensitive configuration</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>bin/magento config:set <span class=o>[</span>--scope<span class=o>]</span> <span class=o>[</span>--scope-code<span class=o>]</span> path value
</code></pre></div><p>Set sensitive configuration (writes to app/etc/env.php)</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>bin/magento config:sensitive:set <span class=o>[</span>--scope<span class=o>]</span> <span class=o>[</span>--scope-code<span class=o>]</span> path value
</code></pre></div><p>Show saved configuration</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>bin/magento config:show
</code></pre></div><p>Export configuration, let op: beschikt niet over gevoelige data!</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>bin/magento app:config:dump
</code></pre></div><p>Example</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>bin/magento config:set --scope<span class=o>=</span>websites --scope-code<span class=o>=</span>base web/unsecure/base_url http://example.com/
</code></pre></div><p>To find the right scope you can run the following sql query in your db:</p><div class=highlight><pre class=chroma><code class=language-sql data-lang=sql><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>store</span><span class=p>;</span><span class=w>
</span><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>store_website</span><span class=p>;</span><span class=w>
</span></code></pre></div><p>With magerun:</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>n98-magerun.phar db:query <span class=s2>&#34;SELECT * FROM store;&#34;</span>
n98-magerun.phar db:query <span class=s2>&#34;SELECT * FROM store_website;&#34;</span>
</code></pre></div><p>For more information, you can consult the following Magento documentation</p><ul><li><a href=https://devdocs.magento.com/guides/v2.2/config-guide/cli/config-cli-subcommands-config-mgmt-set.html>Set configuration values</a></li><li><a href=https://devdocs.magento.com/guides/v2.2/config-guide/prod/config-reference-sens.html>Sensitive and system-specific</a></li><li><a href=https://devdocs.magento.com/guides/v2.2/config-guide/prod/config-reference-most.html>Other configuration paths reference</a></li></ul></div><div class=footer><div class=footer-social><span class="social-icon social-icon-twitter"><a href=https://twitter.com/zerostaticio title=twitter target=_blank rel=noopener><img src=/images/social/twitter.svg width=24 height=24 alt=twitter></a></span>
<span class="social-icon social-icon-github"><a href=https://github.com/zerostaticthemes title=github target=_blank rel=noopener><img src=/images/social/github.svg width=24 height=24 alt=github></a></span>
<span class="social-icon social-icon-linkedin"><a href=https://www.linkedin.com title=linkedin target=_blank rel=noopener><img src=/images/social/linkedin.svg width=24 height=24 alt=linkedin></a></span></div></div></div><script type=text/javascript src=/js/bundle.min.e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855.js></script></body></html>