<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><title>How to Setup a Multistore in Magento 2 - Rick Daalhuizen</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel=icon href=https://rickdaalhuizen.comfavicon.png><link rel=stylesheet href=/css/style.min.4b2bfb3701049fe0da3e8d6b9d15186ba1dc7e294f0be3e2bca21bb8a330f5dd.css><meta name=description content="An easy guide of what multistores are, the hierarchy of a multistore and how you can create them in Magento 2."><meta property="og:title" content="How to Setup a Multistore in Magento 2"><meta property="og:type" content="website"><meta property="og:url" content="https://rickdaalhuizen.com/posts/how-to-setup-a-multistore-in-magento2/"><meta property="og:description" content="An easy guide of what multistores are, the hierarchy of a multistore and how you can create them in Magento 2."><meta name=twitter:card content="summary"><meta name=twitter:site content="@zerostaticio"><meta name=twitter:creator content="@zerostaticio"><link rel=preconnect href=https://fonts.gstatic.com><link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap" rel=stylesheet></head><body class="page page-default-single"><div id=wrapper class=wrapper><div class=header><a class=header-logo href=https://rickdaalhuizen.com>Rick Daalhuizen</a><div class=menu-main><ul><li class=menu-item-about><a href=/pages/about/>About</a></li><li class=menu-item-posts><a href=/posts/>Posts</a></li></ul></div></div><div class=intro><h1>How to Setup a Multistore in Magento 2<span class=dot>.</span></h1></div><div class=content><p>It is possible to configure multiple instances in Magento.</p><p>Each instance can contain different attributes, including Languages, Domain names, Categories, Products, Currencies and more.</p><p>A Magento installation can have multiple websites that have multiple stores or store views.</p><h2 id=magento-2-multistore-hierarchy>Magento 2 multistore hierarchy</h2><p><strong>Global:</strong> At the top of the hierarchy. This is what you get when you install Magento. This includes all default configuration.</p><p><strong>Website:</strong> Magento installations begin with a single website which by default, is called Main Website. You can also set up multiple websites for a single installation, each with its own IP address and domain.</p><p><strong>Store:</strong> A single website can have multiple stores, each with its own main menu. The stores share the same product catalog, but can have a different selection of products and design. All stores under the same website share the same Admin and checkout.</p><p><strong>Store view:</strong> Each store that is available to customers is presented according to a specific view. Initially, a store has a single default view. Additional store views can be added to support different languages, or for other purposes. Customers can use the language chooser in the header to change the store view.</p><figure><img src=magento2-multi-store-diagram.png alt="Magento 2 multistore Diagram"></figure><h2 id=step-1-how-to-create-a-multistore>Step 1: How to create a multistore</h2><p>After we have set up a Magento shop, we can log in as admin in our shop. If you don&rsquo;t have an admin account yet, you can create one as follows:</p><div class=highlight><pre class=chroma><code class=language-zsh data-lang=zsh>bin/magento admin:user:create
</code></pre></div><p>As an example, let&rsquo;s take a website that sells Sport Drinks, as shown in the diagram above.</p><p>Go to Stores -> Settings -> All stores.</p><h2 id=create-a-new-website>Create a new Website</h2><p>Click on Create Website and enter the following:</p><ol><li>The name of your website</li><li>A unique code for your store</li><li>Sort is optional and defaults to 0, let&rsquo;s see how it is for now.</li></ol><figure><img src=magento2-create-new-website.png alt="Magento 2 Create new Website"></figure><h2 id=create-a-new-store>Create a new store</h2><p>Click on Create Store and enter the following:</p><ol><li>Select website</li><li>Name of your Store</li><li>A unique code for your store</li><li>Root category, defaults to default</li></ol><figure><img src=magento2-create-new-store.png alt="Magento 2 Create new Store"></figure><h3 id=create-a-new-store-view>Create a new store view</h3><p>Click on Create Store and enter the following:</p><ol><li>Select store</li><li>Name of your store view</li><li>A unique code for your store</li><li>Status enabled (self-explanatory)</li><li>Sort is optional and defaults to 0, let&rsquo;s see how it is for now.</li></ol><figure><img src=magento2-create-new-store-view.png alt="Magento 2 Create new Store View"></figure><p>This is our result</p><figure><img src=magento2-multistores.png alt="Magento 2 multistores"></figure><h2 id=method-1-configure-base-urls-from-admin>Method 1: Configure base urls from Admin</h2><p>Next we need to set our base url in Stores> Settings> Configuration> General> Web.</p><ol><li>Choose your store view at the top of the page for which you want to set your base url.</li><li>Complete the following fields<ol><li>Base URL: The baseurl of your store view.</li><li>Base Link URL: The base url for your link urls, usually the same as your baseurl.</li><li>Base URL for Static View Files (default value): Let&rsquo;s be default</li><li>Base URL for User Media Files (default value): Enter URL for media files. This is often the baseurl with / media / after it. If you are using a CDN, the url is to your CDN.</li></ol></li></ol><figure><img src=magento2-configure-base-url.png alt="Magento 2 Configure Base Url"></figure><h2 id=method-2-configuring-your-base-urls-using-ssh>Method 2: Configuring your base URL&rsquo;s using SSH</h2><div class=highlight><pre class=chroma><code class=language-zsh data-lang=zsh>bin/magento config:set web/unsecure/base_url <span class=s2>&#34;http://app.sportnutrition.test/&#34;</span> <span class=se>\
</span><span class=se></span>    --scope<span class=o>=</span>website <span class=se>\
</span><span class=se></span>    --scope-code<span class=o>=</span>sportnutrition <span class=se>\
</span><span class=se></span>    -le

bin/magento config:set web/secure/base_url <span class=s2>&#34;https://app.sportdrinks-nl.test/&#34;</span> <span class=se>\
</span><span class=se></span>    --scope<span class=o>=</span>store <span class=se>\
</span><span class=se></span>    --scope-code<span class=o>=</span>sportdrinks_nl <span class=se>\
</span><span class=se></span>    -le
</code></pre></div><h2 id=configure-the-server-to-load-the-storefront>Configure the server to load the storefront</h2><p>Now that we have created a new website for Magento we need to add it to our project. Make sure you are in developer mode.</p><div class=highlight><pre class=chroma><code class=language-zsh data-lang=zsh>bin/magento deploy:mode:set developer
</code></pre></div><p>There are several ways you can do this.</p><ul><li>Add the store code to your base URL, you don&rsquo;t need access to your server for this.</li><li>Create a subfolder with a .htaccess and index.php.</li><li>Using symlinks</li></ul><h2 id=method-1-add-the-store-code-to-your-base-url>Method 1: Add the store code to your base URL.</h2><p>Go to System -> Settings -> Configuration -> General -> Web</p><ol><li>Open the URL Options section:</li><li>Choose Yes in the Add Store Code as you need.</li></ol><p>URL with Store Code:
<a href=https://example.com/store-view/index.php/>https://example.com/store-view/index.php/</a></p><p>URL without Store Code:
<a href=https://example.com/index.php/>https://example.com/index.php/</a></p><h2 id=method-2-create-a-multistore-using-subfolder>Method 2: Create a multistore using subfolder</h2><p>Create a new folder in the root of your project and copy paste the .htaccess to your new folder.</p><div class=highlight><pre class=chroma><code class=language-zsh data-lang=zsh>mkdir -p &lt;new_site&gt; <span class=o>&amp;&amp;</span> cp .htaccess &lt;new_site&gt;
</code></pre></div><p>Then you create an index.php:</p><div class=highlight><pre class=chroma><code class=language-php data-lang=php><span class=o>&lt;?</span><span class=nx>php</span>
 
<span class=k>require</span> <span class=nx>realpath</span><span class=p>(</span><span class=no>__DIR__</span><span class=p>)</span> <span class=o>.</span> <span class=s1>&#39;/../app/bootstrap.php&#39;</span><span class=p>;</span>
<span class=nv>$params</span> <span class=o>=</span> <span class=nv>$_SERVER</span><span class=p>;</span>

<span class=nv>$params</span><span class=p>[</span><span class=nx>\Magento\Store\Model\StoreManager</span><span class=o>::</span><span class=na>PARAM_RUN_CODE</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;&lt;code&gt;&#39;</span><span class=p>;</span>
<span class=nv>$params</span><span class=p>[</span><span class=nx>\Magento\Store\Model\StoreManager</span><span class=o>::</span><span class=na>PARAM_RUN_TYPE</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;&lt;type&gt;&#39;</span><span class=p>;</span>
<span class=nv>$bootstrap</span> <span class=o>=</span> <span class=nx>\Magento\Framework\App\Bootstrap</span><span class=o>::</span><span class=na>create</span><span class=p>(</span><span class=nx>BP</span><span class=p>,</span> <span class=nv>$params</span><span class=p>);</span>

<span class=nv>$app</span> <span class=o>=</span> <span class=nv>$bootstrap</span><span class=o>-&gt;</span><span class=na>createApplication</span><span class=p>(</span><span class=s1>&#39;Magento\Framework\App\Http&#39;</span><span class=p>);</span>
<span class=nv>$bootstrap</span><span class=o>-&gt;</span><span class=na>run</span><span class=p>(</span><span class=nv>$app</span><span class=p>);</span>
</code></pre></div><h2 id=method-3-create-a-multistore-with-symlinks>Method 3: Create a multistore with symlinks</h2><p>Use <em>ln -s &lt;target_dir></em> to create a symlink.</p><div class=highlight><pre class=chroma><code class=language-zsh data-lang=zsh>ln -s &lt;path_to_projet_root&gt;/app/ &lt;your_new_site&gt;app
ln -s &lt;path_to_projet_root&gt;/lib/ &lt;your_new_site&gt;lib
ln -s &lt;path_to_projet_root&gt;/pub/ &lt;your_new_site&gt;pub
ln -s &lt;path_to_projet_root&gt;/var/ &lt;your_new_site&gt;var
</code></pre></div><p>These were the steps to set up a multistore in Magento 2, in my next blog I will explain how you can configure your multistore locally with Docker and Warden.</p></div><div class=footer><div class=footer-social><span class="social-icon social-icon-twitter"><a href=https://twitter.com/zerostaticio title=twitter target=_blank rel=noopener><img src=/images/social/twitter.svg width=24 height=24 alt=twitter></a></span>
<span class="social-icon social-icon-github"><a href=https://github.com/zerostaticthemes title=github target=_blank rel=noopener><img src=/images/social/github.svg width=24 height=24 alt=github></a></span>
<span class="social-icon social-icon-linkedin"><a href=https://www.linkedin.com title=linkedin target=_blank rel=noopener><img src=/images/social/linkedin.svg width=24 height=24 alt=linkedin></a></span></div></div></div><script type=text/javascript src=/js/bundle.min.e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855.js></script></body></html>